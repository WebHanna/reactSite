import React, { Component } from 'react';
import '../main.css';
import { Link } from 'react-router-dom';
import {connect} from 'react-redux';
import {setMore, addBasketItemId} from './actions';


class More extends Component {

    componentWillMount(){
        this.props.devices.forEach((item) => {
            if(this.props.match.params.id === item.id){
                this.props.setMore(item);
            }
        });
    }

    render() {
        if(this.props.moreItem){
            return (
                <div>
                    <div className='view-container'>
                        <div className='container'>
                            <div className='row'>
                                <div className='col-md-9'>
                                    <div className='thumbnail'>
                                        <div className='row'>
                                            <div className='col-md-6 center'>
                                                <img
                                                    className='img-thumbnail'
                                                    src={this.props.moreItem.image}
                                                    alt={this.props.moreItem.image}
                                                />
                                            </div>
                                            <div className='col-md-6 pad'>
                                                {this.props.filterArr.map((item, index) =>
                                                <div className='column' key={index} >
                                                    <div className='ab-details-title'>
                                                        <p>{item[0]}</p>
                                                    </div>
                                                    <div className='ab-details-info'>
                                                        {item[1]}
                                                    </div>
                                                </div>
                                                )}
                                            </div>
                                        </div>
                                        <div className='caption-full'>
                                            <h4 className='pull-right'>${this.props.moreItem.price}</h4>
                                            <h4>{this.props.moreItem.name}</h4>
                                            <p>{this.props.moreItem.description}</p>
                                        </div>
                                    </div>
                                </div>
                                <div className='col-md-3'>
                                    <h3 className='lead'>Quick shop</h3>
                                    <Link to='/basket'>
                                        <div className='cart'>
                                            <div className='dropdown'>
                                                <div className='btn btn-inverse btn-block btn-lg'>
                                                 <i className='fa fa-fa-shopping-cart'/>
                                                    <span> {this.props.all_quantity} item(s) - ${this.props.price}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </Link>
                                    <div className='form-group'>
                                        <h1 className=''>{this.props.moreItem.name}</h1>
                                        <h2 className=''>{this.props.moreItem.price}$</h2>
                                    </div>
                                    <Link to='/' className='btn btn-info btn-block'>Back to store</Link>
                                    <button
                                        type='button'
                                        onClick={() => this.props.addBasketItemId(this.props.moreItem)}
                                        className='btn btn-success btn-block'>
                                        Add to cart
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            )
        } else return false;
    }
}

function mapStateToProps(state) {
    return {
        moreItem: state.more.moreItem,
        filterArr: state.more.filterArr,
        devices: state.date.devices,
        price: state.basket.price,
        all_quantity:state.basket.all_quantity,
    }
}

function mapDispatchToProps(dispatch) {
    return {
        setMore: (item) => setMore(dispatch, item),
        addBasketItemId: (item) => addBasketItemId(dispatch, item),
    }
}

export default connect(mapStateToProps, mapDispatchToProps)(More);